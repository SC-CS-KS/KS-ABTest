# 置信区间 和 抽样误差

* 问题

为比较实验组和对照组的转化率差异，我们需要首先收集实验组和对照组的转化率数据，  
经过7天的观察，对照组的转化率为40%，实验组为41%，是否实验组转化率优于对照组？  

你也许会说因为实验组转化率比对照组高了1%，所以实验组能实现更高的转化率。  
但是由于抽样误差的存在，这样的描述也许并不准确。  
更smart的表述可能是这样的:   

> 我认为实验组转化率相比对照组转化率高0.8-1.2%（1% ± 0.2 %）, 置信度为95%。  

在这句话中，1%是实验组和对照组的绝对差异（即41%-40%）, ± 0.2 % 是抽样误差，  
***绝对差异±抽样误差给出了置信区间的范围***为0.8%-1.2%。

* 置信度

置信度95%说的是我们有95%的自信能说出“实验组转化率相比对照组转化率高0.8-1.2%”这句话。  
从概率论的角度解释，就是在其他参数不变的情况下，如果我们重复做同样的实验100次，  
那么有95次得出的实验组和对照组的转化率差异都在0.8%-1.2%这个区间内。  

* 置信区间  

因此，置信区间是一个区间，使得重复实验n次具有一定概率（这个概率就是置信度）的结果都落在此区间内。  
而置信度是人为给定的，我们需要在实验开始前选定一个置信度（常用90%、95%和99%， 95%在A/B Test中最常用），  
它会影响这个实验所需的样本量大小和显著性检验的结果。  

* 如果我们想知道在这个世界上有多少人喜欢吃橘子  

我们不可能去调查世界上所有人的喜好，只能通过抽样的方法用样本来推断总体。  

假设在这个世界上有50%的人真正喜欢吃橘子，但是否真的是50%我们是不确定的。  
于是我们试图通过随机抽样来检验这个值到底对不对，于是我们每次随机抽取100个样本，并且重复抽样n次。  

如果用 $\overline{p}$ 来表示每次抽样喜欢吃橘子的人的比例，那么重复抽样n次会得到n个 $\overline{p}$ 。   

不管 $\overline{p}$ 落在距离总体均值多么远的地方,   
总有68.2%个落在距离总体均值一个标准差 ( $\sigma$ ) 的范围内，  
95.4%个落在距离总体均值两个标准差 ( $\sigma$ ) 的范围内，  
99.7%个落在距离总体均值三个标准差 ( $\sigma$ ) 的范围内(中心极限定理和正态分布的运用)。  
特别的，***有95%个落在距离总体均值1.96倍个标准差 ( $\sigma$ ) 的范围内***。  

反过来思考，  
***以一次抽样的观测值 $\overline{p}$ 为中心，往前和往后推大约1.96 $\sigma$ 的区间，就有可能抓住那个真实的 $p$***。  
***如果重复抽样无数次，构成无数个这样的区间，有95%个区间会包含真实的 $p$，只有5%个区间不包含***。  

在这个例子里，  
如果一次随机抽样的结果是80%的人喜欢吃橘子，标准差为 $sqrt(0.2*0.8/100)=0.04$，抽样误差为 $1.96*0.04$,   
那么可以说我们95%肯定这个世界上爱吃橘子的人的比率在 [80% ± 1.96 * 0.04] 这个区间内。  

通过上面的例子，我们知道置信区间的上界是样本均值+抽样误差，下界是样本均值-抽样误差，95%置信度下的抽样误差是 $1.96*样本标准差$。

当得到了一个置信区间后，我们需要通过统计上的假设检验来判断这次抽样的结果是否具有统计上的显著性。  
在这个例子中，由于 [80%±1.96*0.04] 这个区间不包含我们事先的假设0.5，并且我们已经95%肯定这个区间包含真实的值，  
那么先前的假设的0.5是非常值得怀疑的，是我们应该拒绝的。接下来，我们需要快速解释假设检验的概念。  

